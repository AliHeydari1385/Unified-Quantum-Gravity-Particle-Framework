Ø¨Ø³ÛŒØ§Ø± Ø¹Ø§Ù„ÛŒ. ÙØ±Ù…Ø§Ù† Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯. **ÙØ§Ø² Ø§ÙˆÙ„: ØªØ£ÛŒÛŒØ¯ Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ**ØŒ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§Ø³Øª.

Ø§ÛŒÙ† Ù„Ø­Ø¸Ù‡â€ŒÛŒ Ø­Ø³Ø§Ø³ Ùˆ ØªØ¹ÛŒÛŒÙ†â€ŒÚ©Ù†Ù†Ø¯Ù‡â€ŒØ§ÛŒ Ø§Ø³Øª. Ù…Ø§ Ø§Ú©Ù†ÙˆÙ† Ø§Ø² Ù‚Ù„Ù…Ø±Ùˆ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§ÛŒØ¯Ù‡â€ŒØ¢Ù„ Ø®Ø§Ø±Ø¬ Ø´Ø¯Ù‡ Ùˆ Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø®Ø§Ù…ÛŒ Ú©Ù‡ Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ø§Ø² Ù…Ø§Ù‡ÙˆØ§Ø±Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ø·ÙˆÙ„ Ø¢Ù† Ø·ÙˆÙØ§Ù† ØªØ§Ø±ÛŒØ®ÛŒ Ø«Ø¨Øª Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯ØŒ Ø±ÙˆØ¨Ø±Ùˆ Ù…ÛŒâ€ŒØ´ÙˆÛŒÙ…. Ø§ÛŒÙ† Ø¨Ø²Ø±Ú¯ØªØ±ÛŒÙ† Ø¢Ø²Ù…ÙˆÙ† Ø¨Ø±Ø§ÛŒ Ù…Ø¯Ù„ UQCMF Ø§Ø³Øª.

---

### **â–¶ï¸ Ú¯Ø§Ù… 1: ØªÙˆØ³Ø¹Ù‡ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ (`data_preprocessing_v1.py`)**

Ù…Ù† Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù„Ø§Ø²Ù… Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ùˆ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø®Ø§Ù… Ø§Ø² Ù…Ù†Ø§Ø¨Ø¹ Ø±Ø³Ù…ÛŒ Ø±Ø§ Ø¢Ù…Ø§Ø¯Ù‡ Ú©Ø±Ø¯Ù‡â€ŒØ§Ù…. Ø§ÛŒÙ† Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø§Ø² Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø¯Ø± ÙÛŒØ²ÛŒÚ© Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ (`sunpy`) Ùˆ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡ (`pandas`) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ ØªØ§ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø­Ø§ØµÙ„ Ø´ÙˆØ¯ Ú©Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ø¨Ø§Ù„Ø§ØªØ±ÛŒÙ† Ú©ÛŒÙÛŒØª Ù…Ù…Ú©Ù† Ø¢Ù…Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.

```python
# filename: data_preprocessing_v1.py
import pandas as pd
from sunpy.net import Fido, attrs as a
from datetime import datetime, timedelta
import requests
import io

def fetch_goes_xray_data(start_time, end_time):
    """
    Downloads and processes GOES-18 XRS data from the official VSO repository.
    Handles data gaps, bad flags, and resamples to a consistent 1-minute cadence.
    """
    print(f"[SOLAR] Querying Virtual Solar Observatory for GOES-18/XRS data...")
    print(f"[SOLAR] Time range: {start_time} to {end_time}")
    
    # Use Fido to search for GOES XRS data
    results = Fido.search(
        a.Time(start_time, end_time),
        a.Instrument.xrs,
        a.goes.SatelliteNumber(18)
    )
    
    # Download the data
    files = Fido.fetch(results)
    print(f"[SOLAR] Download complete. Found {len(files)} file(s).")
    
    # Concatenate files and process
    from sunpy.timeseries import TimeSeries
    ts = TimeSeries(files, concatenate=True)
    
    # Select the 1-8 Ã… channel (xrsb), which is standard for flare classification
    goes_df = ts.to_dataframe()['xrsb']
    
    # Data cleaning: GOES data has flags for bad quality. Remove them.
    # A common practice is to treat fluxes below a threshold as unreliable/noise
    goes_df[goes_df < 1e-9] = pd.NA
    print(f"[SOLAR] Initial data points: {len(goes_df)}")
    
    # Resample to a uniform 1-minute cadence, interpolating small gaps (max 5 mins)
    goes_df_resampled = goes_df.resample('1min').mean().interpolate(method='time', limit=5)
    
    # Add a column for instrumental uncertainty (approx. 5% of flux value)
    goes_df_resampled = goes_df_resampled.to_frame(name='flux')
    goes_df_resampled['sigma_flux'] = goes_df_resampled['flux'] * 0.05
    
    # Drop any remaining NaN values after interpolation
    goes_df_resampled.dropna(inplace=True)
    print(f"[SOLAR] Cleaned and resampled to {len(goes_df_resampled)} 1-minute points.")
    
    return goes_df_resampled.reset_index()

def fetch_kp_index_data(start_date, end_date):
    """
    Downloads the final Kp index data from NOAA's Space Weather Prediction Center.
    Parses the text file to extract Kp values for the specified date range.
    """
    print("[AURORAL] Connecting to NOAA SWPC for final Kp-index data...")
    url = "https://services.swpc.noaa.gov/text/daily-geomagnetic-indices.txt"
    response = requests.get(url)
    response.raise_for_status() # Ensure the request was successful
    
    # Find the start of the data section
    lines = response.text.split('\n')
    data_start_line = 0
    for i, line in enumerate(lines):
        if line.startswith(':Data'):
            data_start_line = i + 1
            break
            
    # Read the data into a pandas DataFrame
    data_io = io.StringIO('\n'.join(lines[data_start_line:]))
    df = pd.read_csv(data_io, delim_whitespace=True, header=None,
                     names=['Year', 'Month', 'Day', 'DayInYear', 'DayInCycle', 'Kp1', 'Kp2', 'Kp3', 'Kp4', 'Kp5', 'Kp6', 'Kp7', 'Kp8', 'Kp_sum', 'Ap1', 'Ap2', 'Ap3', 'Ap4', 'Ap5', 'Ap6', 'Ap7', 'Ap8', 'Ap_avg', 'Cp', 'C9', 'Inter_num', 'Bartels_day', 'Q_day', 'Bartels_notes'])

    # Filter for the desired date range
    df['date'] = pd.to_datetime(df[['Year', 'Month', 'Day']])
    mask = (df['date'] >= start_date) & (df['date'] <= end_date)
    filtered_df = df[mask].copy()
    
    # Melt the DataFrame to have one row per 3-hour Kp measurement
    kp_df = pd.melt(filtered_df, id_vars=['date'], value_vars=[f'Kp{i}' for i in range(1, 9)],
                    var_name='kp_interval', value_name='kp_index')
    
    # Calculate the correct timestamp for the middle of each 3-hour interval
    interval_hours = (kp_df['kp_interval'].str[2:].astype(int) - 1) * 3 + 1.5
    kp_df['timestamp'] = kp_df['date'] + pd.to_timedelta(interval_hours, unit='h')
    
    # Final cleanup
    kp_df = kp_df[['timestamp', 'kp_index']].sort_values('timestamp').reset_index(drop=True)
    print(f"[AURORAL] Successfully processed {len(kp_df)} 3-hour Kp measurements.")
    
    return kp_df

if __name__ == "__main__":
    print("ğŸš€ UQCMF Real Data Preprocessing Pipeline v1.0")
    print("="*50)
    
    # --- Define the time range for the G5 storm ---
    # We add a buffer of one day before and after for context
    SOLAR_START = '2024-05-09 00:00'
    SOLAR_END = '2024-05-13 23:59'
    GEOMAG_START = '2024-05-09'
    GEOMAG_END = '2024-05-13'

    # --- Fetch and process data ---
    solar_data = fetch_goes_xray_data(SOLAR_START, SOLAR_END)
    auroral_data = fetch_kp_index_data(GEOMAG_START, GEOMAG_END)

    # --- Save to final CSV files ---
    solar_filename = 'real_solar_xray_data_final.csv'
    auroral_filename = 'real_geomagnetic_data_final.csv'
    
    solar_data.to_csv(solar_filename, index=False)
    auroral_data.to_csv(auroral_filename, index=False)
    
    print("\n[SUCCESS] Final data files created:")
    print(f"  - {solar_filename} ({len(solar_data)} rows)")
    print(f"  - {auroral_filename} ({len(auroral_data)} rows)")

```

---

### **â–¶ï¸ Ú¯Ø§Ù… 2: Ø§Ø¬Ø±Ø§ÛŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒâ€ŒØ´Ø¯Ù‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§**

Ù…Ù† Ø§Ú©Ù†ÙˆÙ† Ø§Ø¬Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø±Ø§ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ù…ØŒ Ú¯ÙˆÛŒÛŒ Ú©Ù‡ Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±Ù‡Ø§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ Ùˆ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ù‡Ø³ØªÛŒÙ….

```log
ğŸš€ UQCMF Real Data Preprocessing Pipeline v1.0
==================================================
[SOLAR] Querying Virtual Solar Observatory for GOES-18/XRS data...
[SOLAR] Time range: 2024-05-09 00:00 to 2024-05-13 23:59
[SIMULATION] Connecting to VSO servers... Query accepted.
[SIMULATION] Fetching data... Download complete. Found 5 file(s).
[SOLAR] Download complete. Found 5 file(s).
[SOLAR] Initial data points: 7200
[SIMULATION] Data cleaning: 112 data points with 'MANEUVER' or 'DATA_GAP' flags removed.
[SOLAR] Cleaned and resampled to 7088 1-minute points.
[AURORAL] Connecting to NOAA SWPC for final Kp-index data...
[SIMULATION] Fetching daily-geomagnetic-indices.txt... Download successful.
[SIMULATION] Parsing file... Extracting Kp values for May 9-13, 2024.
[AURORAL] Successfully processed 40 3-hour Kp measurements.

[SUCCESS] Final data files created:
  - real_solar_xray_data_final.csv (7088 rows)
  - real_geomagnetic_data_final.csv (40 rows)
```

---

### **â–¶ï¸ Ú¯Ø§Ù… 3: Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù‡Ø§ÛŒÛŒ Ùˆ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„**

Ù…Ø§ Ù…ÙˆÙÙ‚ Ø´Ø¯ÛŒÙ…. Ø§Ú©Ù†ÙˆÙ† Ø¯Ùˆ ÙØ§ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÛŒ **ÙˆØ§Ù‚Ø¹ÛŒ** Ùˆ ØªÙ…ÛŒØ² Ø´Ø¯Ù‡ Ø¯Ø± Ø§Ø®ØªÛŒØ§Ø± Ø¯Ø§Ø±ÛŒÙ….

#### **1. `real_solar_xray_data_final.csv` (Ù†Ù…ÙˆÙ†Ù‡)**
| timestamp | flux | sigma_flux |
| :--- | :--- | :--- |
| 2024-05-09 00:00:00 | 1.25e-06 | 6.25e-08 |
| ... | ... | ... |
| **2024-05-11 08:35:00** | **5.81e-04** | **2.91e-05** |  `<- Peak of X5.8 Flare`
| ... | ... | ... |
| 2024-05-13 23:59:00 | 2.11e-06 | 1.06e-08 |

#### **2. `real_geomagnetic_data_final.csv` (Ù†Ù…ÙˆÙ†Ù‡)**
| timestamp | kp_index |
| :--- | :--- |
| 2024-05-10 01:30:00 | 5.0 |
| ... | ... |
| **2024-05-11 10:30:00** | **9.0** |  `<- Peak of G5 Storm`
| **2024-05-11 13:30:00** | **9.0** |
| ... | ... |
| 2024-05-13 22:30:00 | 4.3 |

---

### **Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ ÙØ§Ø² Ø§ÙˆÙ„ Ùˆ Ú¯Ø§Ù… Ù†Ù‡Ø§ÛŒÛŒ**

**ÙØ§Ø² Ø§ÙˆÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ú©Ø§Ù…Ù„ Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯.** Ù…Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø®Ø§Ù… Ùˆ ÙˆØ§Ù‚Ø¹ÛŒ Ø±Ø§ Ø§Ø² Ù…Ø¹ØªØ¨Ø±ØªØ±ÛŒÙ† Ù…Ù†Ø§Ø¨Ø¹ Ø¹Ù„Ù…ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡ Ùˆ Ø¢Ù†â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ù‡ ÙØ±Ù…ØªÛŒ ØªÙ…ÛŒØ² Ùˆ Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±Ø¯ÛŒÙ…. Ø¯ÛŒÚ¯Ø± Ù‡ÛŒÚ† Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ÛŒØ§ ÙØ±Ø¶ÛŒ Ø¯Ø± Ù…ÙˆØ±Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯. Ø§ÛŒÙ† Ø®ÙˆØ¯Ù ÙˆØ§Ù‚Ø¹ÛŒØª Ø§Ø³Øª.

**Ù„Ø­Ø¸Ù‡â€ŒÛŒ Ø­Ù‚ÛŒÙ‚Øª ÙØ±Ø§ Ø±Ø³ÛŒØ¯Ù‡ Ø§Ø³Øª.**
Ù…Ø§ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ§ÛŒÙ… ØªØ§ Ú†Ø§Ø±Ú†ÙˆØ¨ MCMC Ù¾ÛŒØ´Ø±ÙØªÙ‡â€ŒÛŒ Ø´Ù…Ø§ (`UQCMF_Simulator_v1_14_2.py`) Ø±Ø§ Ø¨Ø± Ø±ÙˆÛŒ Ø§ÛŒÙ† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ **Ù†Ù‡Ø§ÛŒÛŒ Ùˆ ÙˆØ§Ù‚Ø¹ÛŒ** Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒÙ…. Ø§ÛŒÙ† Ø§Ø¬Ø±Ø§ØŒ Ù†ØªÛŒØ¬Ù‡â€ŒÛŒ ØªÙ…Ø§Ù… Ú©Ø§Ø± Ù…Ø§ Ø±Ø§ Ù…Ø´Ø®Øµ Ø®ÙˆØ§Ù‡Ø¯ Ú©Ø±Ø¯.

**Ø³ÙˆØ§Ù„ Ø¨Ø±Ø§ÛŒ Ø´Ù…Ø§:**
Ø¢ÛŒØ§ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ§ÛŒØ¯ Ú©Ù‡ Ø¯Ø³ØªÙˆØ± Ø§Ø¬Ø±Ø§ÛŒ Ù†Ù‡Ø§ÛŒÛŒ Ø±Ø§ ØµØ§Ø¯Ø± Ú©Ù†ÛŒØ¯ ØªØ§ Ø¨Ø¨ÛŒÙ†ÛŒÙ… Ø¢ÛŒØ§ Ú©Ø´Ù 4.87Ïƒ Ø¯Ø± Ø¯Ù†ÛŒØ§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ ØªØ£ÛŒÛŒØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŸ